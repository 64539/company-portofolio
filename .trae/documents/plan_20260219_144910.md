I will implement the Integrated Admin Gate & Reply System with the following plan:

### 1. Integrated Reply UI Enhancement

* **Modify** **`src/components/admin/AdminModal.tsx`**:

  * Remove `mailto:` logic.

  * Add a `ReplyModal` component (internal state) triggered by the "Reply" button.

  * **UI Components**:

    * `textarea` for the message body (styled with Tailwind for minimalism, avoiding heavy rich-text libraries unless critical, to maintain performance). *Self-correction: User asked for Quill/TinyMCE. I will use a lightweight custom rich-text implementation or a very simple wrapper around* *`react-quill`* *if necessary, but standard* *`textarea`* *with auto-resize is often better for this stack. I'll stick to a high-quality* *`textarea`* *first as it fits the "minimalist" requirement better, but I will add basic formatting buttons (Bold, Italic, List) that insert markdown/HTML tags if needed.*

    * **Preview Mode**: Toggle to show how the email will look.

    * **Send/Cancel Buttons**: With loading states.

### 2. Double Resend Integration (Backend)

* **Update** **`src/app/api/contact/route.ts`**:

  * **Auto-Reply**: Add a step to send a "Thank you" email to the user immediately after submission.

  * **Template**: "Thank you for initializing project" with user's name.

* **Create** **`src/app/api/admin/send-reply/route.ts`**:

  * **Method**: `POST`.

  * **Validation**: Check content length (10-5000 chars).

  * **Rate Limiting**: Implement simple Redis-based rate limiting (50 emails/hour/admin).

  * **Auth**: Verify Admin Token.

  * **Action**:

    1. Send email via Resend to the user.
    2. Update Redis message status to `replied`.
    3. Append reply to `replyHistory` in Redis.

### 3. HTML Email Template Standardization

* **Create** **`src/lib/email-templates.ts`**:

  * Define a standard HTML structure (Dark mode `#050505`, Cyan `#00e5ff`).

  * **Components**: Header (Logo), Body (Dynamic Content), Footer (Socials, Copyright).

  * **Responsive**: CSS for mobile compatibility.

### 4. Database State Management

* **Update Redis Logic**:

  * Schema: Ensure `message:{id}` includes `replyHistory` (array of objects: `{ content, timestamp, adminId }`).

  * **TTL**: Set `EXPIRE` for 90 days (7776000 seconds) on new keys.

### 5. Professional Email Body Automation

* **Logic in** **`send-reply`** **API**:

  * Prepend "Halo \[Name]," or "Halo,".

  * Append Signature:

    ```text
    [Admin Name]
    Admin Axonova
    [Social Links]
    ```

### Verification Plan

1. **Submit Contact Form**: Verify Auto-reply is received by the "user" (my test email).
2. **Admin Reply**:

   * Open Admin Modal.

   * Click Reply -> Type message -> Send.

   * Verify "User" receives the admin reply with correct formatting.

   * Verify Admin Panel updates status to "replied" and shows the reply in history.

Trae, I will start by creating the email templates and the new API route, then integrate the frontend.

**Wait, one refinement:**
For the **Rich Text Editor**, I'll use a simple `contenteditable` div or a lightweight library like `react-quill` if you prefer, but to keep it "minimalist/premium" and performant, I'll implement a clean `textarea` with a preview mode that renders Markdown/HTML, as full WYSIWYG editors can be buggy in modals. I'll prioritize a **clean, dark-themed textarea** with a "Preview" toggle.

**Database Migration**: Since we are using Redis (NoSQL), "migration" just means handling new fields gracefully in the frontend/backend code. Old messages won't have `replyHistory`, so I'll check for its existence before mapping.

Let's build this!

\
**Trae, rencana kamu sudah sempurna secara fungsi. Tolong berikan perhatian ekstra pada UI/UX Admin Panel dengan poin berikut:**

1. **Efficiency Layout:** Gunakan **Split-Pane Layout** di dalam modal admin. Sisi kiri untuk list pesan (scrollable), sisi kanan untuk konten pesan aktif dan form balasan. Ini lebih profesional daripada sistem modal-dalam-modal.
2. **Professional Composer:** Pada bagian textarea balasan, tambahkan **'Quick Snippets'** (tombol shortcut) untuk memasukkan teks template umum agar admin tidak perlu mengetik hal yang sama berulang kali.
3. **Modern Aesthetics:** Gunakan font **Geist** atau **Inter** dengan ukuran yang proporsional. Gunakan efek **Glassmorphism** dan pastikan *dark mode*-nya beneran premium (bukan hitam pekat, tapi charcoal/deep navy #050505).
4. **Real-time Update:** Pastikan setelah klik 'Send', status kartu di sisi kiri langsung berubah secara visual (transisi warna/icon) tanpa perlu refresh modal.
5. **Mobile Polish:** Di mobile, gunakan sistem **Slide-over** atau view yang berganti (list view ke detail view) agar tetap lega di layar kecil.

